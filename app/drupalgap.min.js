/*! drupalgap 2016-02-13 */
function core_rest_pre_process(a,b){dg.spinnerShow()}function core_rest_post_process(a){dg.spinnerHide()}var dg={activeTheme:null,blocks:null,regions:null,spinner:0,themes:{},_title:""},drupalgap=dg;dg.settings={mode:"web-app",front:null,blocks:{}},dg.start=function(){"phonegap"==dg.getMode()?document.addEventListener("deviceready",dg.deviceready,!1):dg.deviceready()},dg.deviceready=function(){return dg.bootstrap(),jDrupal.isReady()?void jDrupal.connect().then(this.devicereadyGood,this.devicereadyBad):void dg.alert("Set the sitePath in the settings.js file!")},dg.devicereadyGood=function(a){for(var b in a.drupalgap)a.drupalgap.hasOwnProperty(b)&&(drupalgap[b]=a.drupalgap[b]);dg.router.check(dg.router.getFragment())},dg.devicereadyBad=function(){var a="Failed connection to "+jDrupal.sitePath();""!=msg&&(a+=" - "+msg),dg.alert(a,{title:"Unable to Connect",alertCallback:function(){}})},dg.bootstrap=function(){dg.router.config({});var a=jDrupal.modulesLoad();for(var b in a)if(a.hasOwnProperty(b)&&a[b].routing){var c=a[b].routing();if(c)for(route in c)if(c.hasOwnProperty(route)){var d=c[route];d.key=route,dg.router.add(d)}}dg.themeLoad().then(function(){dg.blocksLoad();dg.router.add(function(){}).listen()})},dg.spinnerShow=function(){dg.spinner++,1==dg.spinner&&(document.getElementById("dgSpinner").style.display="block")},dg.spinnerHide=function(){dg.spinner--,dg.spinner||(document.getElementById("dgSpinner").style.display="none")},dg.Block=function(a,b,c,d){for(var e in c)c.hasOwnProperty(e)&&(this[e]=c[e]);for(var f in d)d.hasOwnProperty(f)&&(this[f]=d[f]);this._id||(this._id=b),this._module||(this._module=a),this._format||(this._format="div"),this._prefix||(this._prefix=""),this._suffix||(this._suffix=""),this._routes||(this._routes=[]),dg.setRenderElementDefaults(this),this._attributes.id||(this._attributes.id=dg.cleanCssIdentifier(b))},dg.Block.prototype.get=function(a){var b="_"+a;return"undefined"!=typeof this[b]?this[b]:null},dg.Block.prototype.set=function(a,b){var c="_"+a;this[c]=b},dg.Block.prototype.buildWrapper=function(){var a=this;return new Promise(function(b,c){a.build().then(function(c){dg.setRenderElementDefaults(c),jDrupal.moduleInvokeAll("block_view_alter",c,a).then(function(){a.set("content",c),b(a)})})})},dg.Block.prototype.build=function(){return new Promise(function(a,b){a("")})},dg.Block.prototype.getVisibility=function(){var a=this,b=dg.currentUser();return new Promise(function(c,d){var e=!0,f=function(){c({visible:e,block:a})},g=a.get("access");if(g)return e=g.call(),void f();var h=a.get("roles");if(h){e=!1;for(var i=0;i<h.length&&!(e=b.hasRole(h[i].target_id)?h[i].visible:!h[i].visible);i++);}var j=a.get("routes");if(j.length){e=!1;for(var k=dg.getRoute(),i=0;i<j.length;i++)if(k.key==j[i].key)if(j[i].target_id){if(b.hasRole(j[i].target_id)&&(e=j[i].visible))break}else if(e=j[i].visible)break}f()})},dg.blocksLoad=function(){if(!dg.blocks){dg.blocks={};var a={},b=dg.config("theme").name,c=dg.settings.blocks[b],d=0;for(var e in c)if(c.hasOwnProperty(e)){var f=0;for(var g in c[e])if(c[e].hasOwnProperty(g)){var h=c[e][g];h._region=e,h._weight="undefined"!=typeof h._weight?h._weight:f,f=h._weight+1,a[g]=h,d++}}0==d&&console.log(dg.t("No blocks found in settings.js for the theme: "+b));var i=jDrupal.modulesLoad();for(var j in i)if(i.hasOwnProperty(j)&&i[j].blocks){var k=i[j].blocks();if(k)for(h in k)if(k.hasOwnProperty(h)&&a[h]){var l=k[h];if(dg.blocks[h]){var m='WARNING - The "'+h+'" block provided by the "'+dg.blocks[h].get("module")+'" module has been overwritten by the "'+j+'" module.';console.log(m)}dg.blocks[h]=new dg.Block(j,h,l,a[h])}}}return dg.blocks},dg.blockLoad=function(a){return dg.blocks[a]?dg.blocks[a]:null},dg.config=function(a){var b="undefined"!=typeof arguments[1]?arguments[1]:null;return b?void(dg.settings[a]=b):dg.settings[a]},dg.getMode=function(){return this.config("mode")},dg.setMode=function(a){this.config("mode",a)},dg.getRoute=function(){return dg.router.load(dg.getPath())},dg.getPath=function(){var a=dg.router.getFragment();return""==a&&(a=dg.getFrontPagePath()),a},dg.getFrontPagePath=function(){var a=dg.config("front");return null==a&&(a="dg"),a},dg.isFrontPage=function(){return dg.getFrontPagePath()==dg.getPath()||""==dg.getPath()},dg.getTitle=function(){return dg._title},dg.isProperty=function(a,b){return b.hasOwnProperty(a)&&"_"==a.charAt(0)},dg.setTitle=function(a){a=a?a:"","object"==typeof a&&(a=a._title?a._title:""),dg._title=a},dg.getDocumentTitle=function(){return document.title},dg.setDocumentTitle=function(a){a=a?a:dg.config("title"),document.title=dg.theme("document_title",{_title:dg.t(a)})},dg.attributes=function(a){var b="";if(a)for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];Array.isArray(d)&&d.length?b+=c+'="'+d.join(" ")+'" ':""!=d?b+=c+'="'+d+'" ':"class"!=c&&(b+=c+" ")}return b},dg.applyToConstructor=function(a,b){var c=[null].concat(b),d=a.bind.apply(a,c);return new d},dg.cleanCssIdentifier=function(a){return a.replace(/_/g,"-").toLowerCase()},dg.getCamelCase=function(a){return a.replace(/[-_]([a-z])/g,function(a){return a[1].toUpperCase()})},dg.killCamelCase=function(a,b){return jDrupal.lcfirst(a).replace(/([A-Z])/g,b+"$1").toLowerCase()},dg.imagePath=function(a){var b=dg.restPath()+a;return-1!=b.indexOf("public://")?b=b.replace("public://",dg.config("files").publicPath+"/"):-1!=b.indexOf("private://")&&(b=b.replace("private://",dg.config("files").privatePath+"/")),b},dg.l=function(a,b,c){return c||(c={}),c._text||(c._text=a),c._path||(c._path=b),dg.theme("link",c)},dg.bl=function(a,b,c){return this.l.apply(this,arguments)},dg.removeElement=function(a){var b=document.getElementById(a);b.parentElement.removeChild(b)},dg.t=function(a,b,c){if(b)for(var d in b)b.hasOwnProperty(d)&&(a=a.replace(d,b[d]));return a},dg.Node=function(a){return new jDrupal.Node(a)},dg.entityRenderContent=function(a){return new Promise(function(b,c){var d=a.getEntityType(),e=a.getBundle(),f=(a.getEntityKey("label"),{});dg.setTitle({_theme:"entity_label",_entity:a,_title:a.label(),_attributes:{"class":[d+"-title"]}}),dg.setDocumentTitle(a.label());var g=e?dg.entity_view_mode[d][e]:dg.entity_view_mode[d];"user"==d&&(g=g[d]);for(var h in g)if(g.hasOwnProperty(h)){var i=dg.fieldStorageConfig[d][h];if(i){var j=i.module,k=g[h].type;if(!jDrupal.moduleExists(j)){var l='entityRenderContent - The "'+j+'" module is not present to render the "'+h+'" field.';console.log(l);continue}if(!dg.modules[j].FieldFormatter||!dg.modules[j].FieldFormatter[k]){console.log('entityRenderContent - There is no "'+k+'" formatter in the "'+j+'" module to handle the "'+h+'" field.');continue}var m=new dg.FieldItemListInterface(a.get(h)),n=new dg.FieldDefinitionInterface(d,e,h),o=new dg.modules[j].FieldFormatter[k](n,g[h].settings,g[h].label,g[h],g[h].third_party_settings),p=o.viewElements(m,a.language());if(jDrupal.isEmpty(p))continue;var q={};"hidden"!=g[h].label&&(q.label={_theme:"form_element_label",_title:n.getLabel(),_title_display:"before"}),q.elements=p,f[h]={_theme:"container",_children:q,_attributes:{"class":[h.replace(/_/g,"-")]},_weight:g[h].weight}}else console.log('entityRenderContent - No field storage config for "'+h+'"')}jDrupal.moduleInvokeAll("entity_view",f,a).then(b(f))})},dg.theme_entity_label=function(a){return"<h1 "+dg.attributes(a._attributes)+">"+dg.t(a._entity.label())+"</h1>"},dg.forms={},dg.Form=function(a){this.id=a,this.form={_attributes:{id:dg.killCamelCase(a,"-").toLowerCase(),"class":[]},_validate:[a+".validateForm"],_submit:[a+".submitForm"],_after_build:[]},this.form_state=new dg.FormStateInterface(this),this.elements={}},dg.Form.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.Form.prototype.getFormId=function(){return this.get("id")},dg.Form.prototype.getForm=function(){var a=this;return new Promise(function(b,c){a.buildForm(a.form,a.form_state).then(function(){for(name in a.form)if(dg.isFormElement(name,a.form)){var c=a.form[name];if("actions"==c._type){dg.setFormElementDefaults(name,c);for(_name in c)dg.isFormElement(_name,c)&&dg.setFormElementDefaults(_name,c[_name])}else dg.setFormElementDefaults(name,c)}var d=jDrupal.moduleInvokeAll("form_alter",a.form,a.getFormState(),a.getFormId()),e=function(){for(var c in a.form)if(dg.isFormElement(c,a.form)){var d=a.form[c];switch(d._attributes.value!=d._value&&(d._attributes.value=d._value),d._widgetType){case"FieldWidget":case"FormWidget":var e=a.form._entity.get(c),f=0,g=new dg.modules[d._module][d._widgetType][d._type](a.form._entityType,a.form._bundle,c,d,e,f);if(a.elements[c]=g,g.form(e,f,d,a.form,a.form_state),"hidden"==d._type){a.form[c]=d;continue}var h={};d._title&&(h.label={_theme:"form_element_label",_title:d._title}),h.element=d;var i={_theme:"container",_children:h,_weight:d._weight};a.form[c]=i;break;case"FormElement":default:var j=new dg[d._widgetType](c,d,a);if(a.elements[c]=j,"hidden"==j._type){a.elements[c]=j;continue}var h={_attributes:{"class":[]}};d._title&&!d._attributes.placeholder&&(h.label={_theme:"form_element_label",_title:d._title,_attributes:{"class":[],"for":d._attributes.id}}),h.element=j;var i={_theme:"container",_children:h,_attributes:{"class":[]},_weight:d._weight};a.form[c]=i}}for(var k=[],l=0;l<a.form._after_build.length;l++){var m=a.form._after_build[l].split("."),n=m[0],o=m[1];dg.modules[n]&&dg.modules[n][o]&&k.push(dg.modules[n][o].apply(a,[a.form,a.getFormState()]))}Promise.all(k).then(function(){b("<form "+dg.attributes(a.form._attributes)+">"+dg.render(a.form)+"</form>")})};d?d.then(e):e()})})},dg.Form.prototype.getFormState=function(){return this.form_state},dg.Form.prototype.buildForm=function(a,b,c){return new Promise(function(a,b){a()})},dg.Form.prototype.validateForm=function(a){return new Promise(function(a,b){a()})},dg.Form.prototype.submitForm=function(a,b,c){return new Promise(function(a,b){a()})},dg.Form.prototype._submission=function(){var a=this;return new Promise(function(b,c){var d=a.getFormState();d.setFormState().then(function(){d.clearErrors(),a._validateForm().then(function(){return d.hasAnyErrors()?(d.displayErrors(),void c()):void a._submitForm(a,d).then(function(){a.form._action&&dg["goto"](a.form._action),dg.removeForm(a.getFormId()),b()})})})})},dg.Form.prototype._validateForm=function(){var a=this,b=a.getFormState(),c=function(a){b.setErrorByName(a,dg.t('The "'+a+'" field is required'))};for(var d in a.form)if(dg.isFormElement(d,a.form)){var e=a.form[d];if(e._theme&&"container"==e._theme){if("function"!=typeof e._children.element.get)continue;"undefined"!=typeof e._children.element.get("element")._required&&e._children.element.get("element")._required&&jDrupal.isEmpty(b.getValue(d))&&c(d)}else"undefined"!=typeof e._required&&e._required&&jDrupal.isEmpty(b.getValue(d))&&c(d)}for(var f=[],g=0;g<a.form._validate.length;g++){var h=a.form._validate[g].split("."),i=h[0],j=h[1];i!=this.getFormId()||"validateForm"!=j?window[i]&&window[i][j]&&f.push(window[i][j].apply(a,[a.form,a.getFormState()])):f.push(this[j].apply(a,[a.form,a.getFormState()]))}return Promise.all(f)},dg.Form.prototype._submitForm=function(){for(var a=this,b=[],c=0;c<a.form._submit.length;c++){var d=a.form._submit[c].split("."),e=d[0],f=d[1];e!=this.getFormId()||"submitForm"!=f?dg.modules[e]&&dg.modules[e][f]&&b.push(dg.modules[e][f].apply(a,[a.form,a.getFormState()])):b.push(this[f].apply(a,[a.form,a.getFormState()]))}return Promise.all(b)},dg.addForm=function(a,b){return this.forms[a]=b,this.forms[a]},dg.loadForm=function(a){return this.forms[a]?this.forms[a]:null},dg.loadForms=function(){return this.forms},dg.removeForm=function(a){delete this.forms[a]},dg.removeForms=function(){this.forms={}},dg.isFormElement=function(a,b){return b.hasOwnProperty(a)&&"_"!=a.charAt(0)},dg.isFormProperty=function(a,b){return b.hasOwnProperty(a)&&"_"==a.charAt(0)},dg.setFormElementDefaults=function(a,b){var c=b._attributes?b._attributes:{};c.id||(c.id="edit-"+a.toLowerCase().replace(/_/g,"-")),c.name||(c.name=a),c["class"]||(c["class"]=[]),!c.value&&b._value&&(c.value=b._value),b._widgetType||(b._widgetType="FormElement"),b._title_placeholder&&(c.placeholder=b._title),b._attributes=c},dg.FormElement=function(a,b,c){this.name=a,this.element=b,this.form=c},dg.FormElement.prototype.id=function(){return this.element?this.element._attributes.id:null},dg.FormElement.prototype.getForm=function(){return this.form},dg.FormElement.prototype.get=function(a){return this[a]},dg.FormElement.prototype.getElement=function(a){return this.get("element")[a]},dg.FormElement.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:d})})},dg.theme_form_element_label=function(a){return"<label "+dg.attributes(a._attributes)+">"+a._title+"</label>"},dg.theme_actions=function(a){var b="";for(prop in a)dg.isFormElement(prop,a)&&(b+=dg.render(a[prop]));return b},dg.theme_hidden=function(a){return a._attributes.type="hidden","<input "+dg.attributes(a._attributes)+" />"},dg.theme_number=function(a){return a._attributes.type="number","<input "+dg.attributes(a._attributes)+"/>"},dg.theme_password=function(a){return a._attributes.type="password","<input "+dg.attributes(a._attributes)+" />"},dg.theme_select=function(a){var b="";if(a._options)for(var c in a._options)if(a._options.hasOwnProperty(c)){var d=a._options[c];if("object"==typeof d)"undefined"!=typeof a._value&&a._value==c&&(d._attributes.selected=""),b+=dg.render(d);else{var e="";"undefined"!=typeof a._value&&a._value==c&&(e=" selected "),b+='<option value="'+c+'" '+e+">"+d+"</option>"}}return"<select "+dg.attributes(a._attributes)+">"+b+"</select>"},dg.theme_submit=function(a){a._attributes.type="submit";return!a._attributes.value&&a._value&&(a._attributes.value=a._value),"<input "+dg.attributes(a._attributes)+"/>"},dg.theme_textarea=function(a){var b=a._value?a._value:"";return"<textarea "+dg.attributes(a._attributes)+">"+b+"</textarea>"},dg.theme_textfield=function(a){return a._attributes.type="text","<input "+dg.attributes(a._attributes)+"/>"},dg.FormStateInterface=function(a){this.form=a,this.values={},this.errors={}},dg.FormStateInterface.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.FormStateInterface.prototype.set=function(a,b){this[a]=b},dg.FormStateInterface.prototype.setFormState=function(){var a=this,b=a.get("form"),c=[];for(var d in b.elements)"actions"!=d&&c.push(b.elements[d].valueCallback());return Promise.all(c).then(function(b){for(var c=0;c<b.length;c++)a.setValue(b[c].name,b[c].value)})},dg.FormStateInterface.prototype.setErrorByName=function(a,b){this.errors[a]=b},dg.FormStateInterface.prototype.getErrors=function(){return this.errors},dg.FormStateInterface.prototype.hasAnyErrors=function(){var a=!1,b=this.getErrors();for(error in b)if(b.hasOwnProperty(error)){a=!0;break}return a},dg.FormStateInterface.prototype.getErrorMessages=function(){var a="",b=this.getErrors();for(error in b)b.hasOwnProperty(error)&&(a+=b[error]+"\n");return a},dg.FormStateInterface.prototype.displayErrors=function(){dg.alert(this.getErrorMessages())},dg.FormStateInterface.prototype.clearErrors=function(){this.errors={}},dg.FormStateInterface.prototype.getValue=function(a,b){return"undefined"!=typeof this.get("values")[a]?this.get("values")[a]:b},dg.FormStateInterface.prototype.setValue=function(a,b){this.values[a]=b},dg.FormStateInterface.prototype.getValues=function(){return this.get("values")},dg.FormStateInterface.prototype.setValues=function(a){this.values=a},dg.FormWidget=function(a,b,c,d,e,f){},dg.FormWidget.prototype=new dg.FormElement,dg.FormWidget.prototype.constructor=dg.FormWidget,dg.FormWidgetPrepare=function(a,b){a.widgetType="FormWidget",a.entityType=b[0],a.bundle=b[1],a.fieldName=b[2],a.name=a.fieldName,a.element=b[3],a.items=b[4],a.delta=b[5],a.fieldFormMode=a.element._fieldFormMode},dg.FormWidget.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:[{value:d}]})})},dg.FieldDefinitionInterface=function(a,b,c){this.entityType=a,this.bundle=b,this.fieldName=c,this.fieldDefinition="user"==a?dg.fieldDefinitions[a][c]:dg.fieldDefinitions[a][b][c]},dg.FieldDefinitionInterface.prototype.get=function(a){return this.fieldDefinition[a]},dg.FieldDefinitionInterface.prototype.getLabel=function(){return this.get("label")},dg.FieldFormMode=function(a){this.fieldFormMode=a},dg.FieldFormMode.prototype.getWeight=function(){return this.fieldFormMode.weight},dg.FieldFormatter=function(){},dg.FieldFormatterPrepare=function(a,b){a._fieldDefinition=b[0],a._settings=b[1],a._label=b[2],a._viewMode=b[3],a._thirdPartySettings=b[4]},dg.FieldFormatter.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_markup:c[e].value};return d},dg.FieldItemListInterface=function(a){this._items=a},dg.FieldItemListInterface.prototype.getItems=function(){return this._items},dg.FieldWidget=function(a,b,c,d,e,f){},dg.FieldWidget.prototype=new dg.FormElement,dg.FieldWidget.prototype.constructor=dg.FieldWidget,dg.FieldWidgetPrepare=function(a,b){a.widgetType="FieldWidget",a.entityType=b[0],a.bundle=b[1],a.fieldName=b[2],a.name=a.fieldName,a.element=b[3],a.items=b[4],a.delta=b[5],a.fieldDefinition=new dg.FieldDefinitionInterface(a.entityType,a.bundle,a.fieldName),a.fieldFormMode=a.element._fieldFormMode},dg.FieldWidget.prototype.getSetting=function(a){return this.settings[a]},dg.FieldWidget.prototype.setSetting=function(a,b){this.settings[property]=b},dg.FieldWidget.prototype.getSettings=function(){return this.settings},dg.FieldWidget.prototype.setSettings=function(a){this.settings=a},dg.FieldWidget.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:[{value:d}]})})},dg["goto"]=function(a){this.router.navigate(a)},dg.alert=function(a){var b=null;arguments[1]&&(b=arguments[1]);var c=function(){},d="Alert",e="OK";b&&(b.alertCallback&&(c=b.alertCallback),b.title&&(d=b.title),b.buttonName&&(e=b.buttonName)),"phonegap"!=dg.config("mode")||"undefined"==typeof navigator.notification?(alert(a),c()):navigator.notification.alert(a,c,d,e)},dg.theme_message=function(a){var b=a._format?a._format:"div",c=a._type?a._type:null;return jDrupal.inArray("messages",a._attributes["class"])||a._attributes["class"].push("messages"),c&&!jDrupal.inArray(c,a._attributes["class"])&&a._attributes["class"].push(c),"<"+b+" "+dg.attributes(a._attributes)+">"+a._message+"</"+b+">"},dg.modules=jDrupal.modules,dg.Module=function(){},dg.Module.prototype=new jDrupal.Module,dg.Module.prototype.constructor=dg.Module,dg.Module.prototype.routing=function(){return null},dg.Region=function(a,b){this._id=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);this._attributes||(this._attributes={}),this._attributes.id||(this._attributes.id=a),this._format||(this._format="div"),this._prefix||(this._prefix=""),this._suffix||(this._suffix="")},dg.Region.prototype.get=function(a){var b="_"+a;return"undefined"!=typeof this[b]?this[b]:null},dg.Region.prototype.set=function(a,b){var c="_"+property;this[c]=b},dg.loadRegions=function(){},dg.Region.prototype.getBlocks=function(){var a=dg.blocksLoad(),b={};for(var c in a)a.hasOwnProperty(c)&&a[c].get("region")==this.get("id")&&(b[a[c].get("weight")]=c);var d=[];for(var e in b)b.hasOwnProperty(e)&&d.push(b[e]);return d},dg._postRender=[],dg.appRender=function(a){dg.themeLoad().then(function(b){dg.regions={};var c=b.getRegions(),d="",e=(b.getRegionCount(),function(b){for(var c in dg.regions)if(dg.regions.hasOwnProperty(c)){var e=dg.regions[c],f=e.getBlocks(),g=e.get("format");d+="<"+g+" "+dg.attributes(e.get("attributes"))+">"+e.get("prefix");for(var h=0;h<f.length;h++){var i=b[f[h]],j=i.get("format");d+=i.get("prefix")+"<"+j+" "+dg.attributes(i.get("attributes"))+"></"+j+">"+i.get("suffix")}d+=e.get("suffix")+"</"+g+">"}d+=dg.render(a),document.getElementById("dg-app").innerHTML=d;var f=dg.blocksLoad(),k=[],l=function(a){function b(a){a.preventDefault&&a.preventDefault();var b=dg.loadForm(jDrupal.ucfirst(dg.getCamelCase(this.id)));return b._submission().then(function(){},function(){}),!1}if(k.splice(k.indexOf(a.get("id")),1),0==k.length){if(dg._postRender.length){for(var c=0;c<dg._postRender.length;c++)dg._postRender[c]();dg._postRender=[]}var d=dg.loadForms();for(var e in d)if(d.hasOwnProperty(e)){var f=dg.killCamelCase(e,"-"),g=document.getElementById(f);g.attachEvent?g.attachEvent("submit",b):g.addEventListener("submit",b)}}};for(c in f)f.hasOwnProperty(c)&&(k.push(c),f[c].getVisibility().then(function(a){a.visible?a.block.buildWrapper().then(function(a){var b=dg.cleanCssIdentifier(a.get("id"));document.getElementById(b).innerHTML=dg.render(a.get("content"));l(a)}):(dg.removeElement(dg.cleanCssIdentifier(a.block.get("id"))),l(a.block))}))}),f=function(){var a={};for(var b in dg.regions)if(dg.regions.hasOwnProperty(b))for(var c=dg.regions[b].getBlocks(),d=0;d<c.length;d++)a[c[d]]=dg.blockLoad(c[d]);jDrupal.moduleInvokeAll("blocks_build_alter",a).then(e(a))};for(var g in c)if(c.hasOwnProperty(g)){var h=new dg.Region(g,c[g]);0!=h.getBlocks().length&&(dg.setRenderElementDefaults(h),dg.regions[g]=h)}jDrupal.moduleInvokeAll("regions_build_alter",dg.regions).then(f)})},dg.renderProperties=function(){return["_prefix","_suffix","_preRender","_postRender"]},dg.render=function(a){var b=typeof a;if(!a)return"";if("string"===b)return a;var c="";if("object"===b){var d=a._prefix?a._prefix:"",e=a._suffix?a._suffix:"";if("object"==typeof d&&(d=dg.render(d)),"object"==typeof e&&(e=dg.render(e)),"undefined"==typeof a._postRender&&(a._postRender=[]),a.markup&&(console.log('DEPRECATED: Use "_markup" instead of "markup" in this render array:'),console.log(a),a._markup=a.markup),a._postRender.length)for(var f=0;f<a._postRender.length;f++)dg._postRender.push(a._postRender[f]);if(a._markup)return d+a._markup+e;if(a._theme)return d+dg.theme(a._theme,a)+e;if(a._type)return d+dg.theme(a._type,a)+e;var g={},h=0;c+=d;for(var i in a)if(a.hasOwnProperty(i)&&!jDrupal.inArray(i,dg.renderProperties())){var j=a[i],k=typeof j;if("object"===k&&null!==j){var l="undefined"!=typeof j._weight?j._weight:0;"undefined"==typeof g[l]&&(g[l]=[]),g[l].push(dg.render(j)),h++}else if("array"===k)for(var f=0;f<j.length;f++)c+=dg.render(j[f])}if(h)for(var l in g)if(g.hasOwnProperty(l))for(var f=0;f<g[l].length;f++)c+=g[l][f];c+=e}else if("array"===b)for(var f=0;f<a.length;f++)c+=dg.render(a[f]);return c},dg.token=function(){return jDrupal.token()},dg.restPath=function(){return jDrupal.restPath()},dg.path=function(){return jDrupal.path()},dg.commentLoad=function(){return jDrupal.commentLoad.apply(jDrupal,arguments)},dg.nodeLoad=function(){return jDrupal.nodeLoad.apply(jDrupal,arguments)},dg.userLoad=function(){return jDrupal.userLoad.apply(jDrupal,arguments)},dg.viewsLoad=function(){return jDrupal.viewsLoad.apply(jDrupal,arguments)},dg.router={routes:[],mode:null,root:"/",config:function(a){return this.mode=a&&a.mode&&"history"==a.mode&&history.pushState?"history":"hash",this.root=a&&a.root?"/"+this.clearSlashes(a.root)+"/":"/",this},getFragment:function(){var a="";if("history"===this.mode)a=this.clearSlashes(decodeURI(location.pathname+location.search)),a=a.replace(/\?(.*)$/,""),a="/"!=this.root?a.replace(this.root,""):a;else{var b=window.location.href.match(/#(.*)$/);a=b?b[1]:""}return this.clearSlashes(a)},prepFragment:function(a){var b=a||this.getFragment();return this.root+b},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},add:function(a){return this.routes.push(a),this},remove:function(a){for(var b,c=0;c<this.routes.length,b=this.routes[c];c++)if(b.path.toString()===a.toString())return this.routes.splice(c,1),this;return this},flush:function(){return this.routes=[],this.mode=null,this.root="/",this},check:function(a){var b=this.load(a);if(b){dg.removeForms();var c=this.matches(a).match,d=function(a){dg.content=a,dg.appRender(),jDrupal.moduleInvokeAll("post_process_route_change",b,dg.getPath())};if(b.defaults||(b=this.load(dg.getFrontPagePath())),b.defaults)if(dg.setTitle(b.defaults._title),dg.setDocumentTitle(b.defaults._title),b.defaults._form){var e=b.defaults._form;c.length>1?(c.shift(),dg.addForm(e,dg.applyToConstructor(window[e],c)).getForm().then(d)):dg.addForm(e,new window[e]).getForm().then(d)}else c.length>1?(c.shift(),b.defaults._controller.apply(null,c).then(d)):b.defaults._controller().then(d)}return this},listen:function(){var a=this,b=a.getFragment(),c=function(){b!==a.getFragment()&&(b=a.getFragment(),a.check(b))};return clearInterval(this.interval),this.interval=setInterval(c,50),this},load:function(a){var b=this.matches(a);return b?this.routes[b.i]:null},matches:function(a){for(var b=this.prepFragment(a),c=0;c<this.routes.length;c++){var d=b.match(this.routes[c].path);if(d)return{match:d,i:c}}return null},navigate:function(a){if(a=a?a:"","history"===this.mode){var b=this.root+this.clearSlashes(a);history.pushState(null,null,b)}else window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a;return this},getRoutes:function(){return this.routes}},dg.Theme=function(){this.regions=null},dg.Theme.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.Theme.prototype.getRegions=function(){return this.get("regions")},dg.Theme.prototype.getRegionCount=function(){var a=0,b=this.get("regions");for(var c in b)b.hasOwnProperty(c)&&a++;return a},dg.themeLoad=function(){return new Promise(function(a,b){if(!dg.activeTheme){var c=dg.config("theme").name,d=jDrupal.ucfirst(dg.getCamelCase(c));if(!dg.themes[d]){var e="themeLoad failed ("+d+") - did you include its .js file in the index.html file?";return void b(e)}dg.activeTheme=new dg.themes[d]}a(dg.activeTheme)})},dg.theme=function(a,b){try{if(b||(b={}),b._markup)return b._markup;var c="",d="theme_"+a;if(!jDrupal.functionExists(dg[d])){var e=null;arguments.callee.caller&&(e=arguments.callee.caller.name);var f="WARNING: "+d+"() does not exist.";return e&&(f+=" Called by: "+e+"()."),console.log(f),c}dg.setRenderElementDefaults(b);var g=dg[d].call(null,b);return g instanceof Promise?(g.then(function(a){document.getElementById(a.variables._attributes.id).innerHTML=dg.render(a.content)}),"<div "+dg.attributes(b._attributes)+"></div>"):g}catch(h){console.log("dg.theme - "+h)}},dg.setRenderElementDefaults=function(a){if("object"==typeof a){"undefined"==typeof a._attributes&&(a._attributes={}),"undefined"==typeof a._attributes["class"]&&(a._attributes["class"]=[]);for(var b in a)a.hasOwnProperty(b)&&!dg.isProperty(b,a)&&"object"==typeof a[b]&&dg.setRenderElementDefaults(a[b])}},dg.currentUser=function(){return jDrupal.currentUser()},dg.userPassword=function(){return jDrupal.userPassword.apply(jDrupal,arguments)},dg.theme_view=function(a){if(!a._attributes.id){var b="WARNING: dg.theme_view - no attribute id was provided, so a random one was generated for the following View widget: "+dg.restPath()+a._path;console.log(b),a._attributes.id=dg.userPassword()}return new Promise(function(b){jDrupal.viewsLoad(a._path).then(function(c){var d="",e=a._format?a._format:"div",f=a._format_attributes?a._format_attributes:null;if(a._title&&(d+="object"==typeof a._title?dg.render(a._title):"<h2>"+a._title+"</h2>"),d+="<"+e+" "+dg.attributes(f)+">",c.results.length>0)for(var g=0;g<c.results.length;g++){var h="",i="";switch(e){case"ul":case"ol":h="<li>",i="</li>";break;case"table":h="<tr>",i="</tr>"}d+=h+a._row_callback(c.results[g])+i}d+="</"+e+">",b({variables:a,content:d})})})},dg.theme_button=function(a){return a._value||(a._value=""),"<button "+dg.attributes(a._attributes)+">"+a._value+"</button>"},dg.theme_link=function(a){var b=a._text?a._text:"",c=a._path;if(""==c&&(c=dg.getFrontPagePath()),"undefined"==typeof a._attributes.href&&c){var d=c;-1!=c.indexOf("http://")||-1!=c.indexOf("https://")||(d=0==c.indexOf("/")?c:"#"+c),c!=dg.getPath()||jDrupal.inArray("active",a._attributes["class"])||a._attributes["class"].push("active"),a._attributes.href=d}return"<a "+dg.attributes(a._attributes)+">"+b+"</a>"},dg.theme_image=function(a){a._attributes.src=a._attributes.src?a._attributes.src:a._path;var b=a._attributes.src;return(b&&-1!=b.indexOf("public://")||-1!=b.indexOf("private://"))&&(a._attributes.src=dg.imagePath(b)),a._attributes.alt=a._attributes.alt?a._attributes.alt:a._alt,a._attributes.title=a._attributes.title?a._attributes.title:a._title,"<img "+dg.attributes(a._attributes)+"/>"},dg.theme_item_list=function(a){var b="",c=a._type?a._type:"ul";if(a._title&&(b+="object"==typeof a._title?dg.render(a._title):"<h3>"+a._title+"</h3>"),b+="<"+c+" "+dg.attributes(a._attributes)+">",a._items&&a._items.length>0)for(var d in a._items)if(a._items.hasOwnProperty(d)){var e=a._items[d];"object"==typeof e&&(e=dg.render(e));var f={};0==d?f["class"]=["first"]:d==a._items.length-1&&(f["class"]=["last"]),b+="<li "+dg.attributes(f)+">"+e+"</li>"}return b+="</"+c+">"},dg.theme_title=function(a){return"<h1 "+dg.attributes(a._attributes)+">"+a._title+"</h1>"},dg.theme_document_title=function(a){return a._title+" | "+dg.config("title")},dg.modules.admin=new dg.Module,dg.modules.admin.blocks=function(){var a={};return a.admin_menu={build:function(){return new Promise(function(a,b){var c={};c.menu={_theme:"item_list",_title:"Administer",_items:[dg.l(dg.t("Content"),"node/add")]},a(c)})}},a},dg.modules.core=new dg.Module,dg.modules.core=new dg.Module,dg.modules.core.FieldFormatter={},dg.modules.core.FieldFormatter.entity_reference_label=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.core.FieldFormatter.entity_reference_label.prototype=new dg.FieldFormatter,dg.modules.core.FieldFormatter.entity_reference_label.prototype.constructor=dg.modules.core.FieldFormatter.entity_reference_label,dg.modules.core.FieldFormatter.entity_reference_label.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_theme:"entity_reference_label",_item:c[e]};return d},dg.modules.core.FieldFormatter.number_decimal=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.core.FieldFormatter.number_decimal.prototype=new dg.FieldFormatter,dg.modules.core.FieldFormatter.number_decimal.prototype.constructor=dg.modules.core.FieldFormatter.number_decimal,dg.modules.core.FieldFormatter.number_decimal.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_theme:"number_decimal",_item:c[e]};return d},dg.modules.core.FieldFormatter.number_float=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.core.FieldFormatter.number_float.prototype=new dg.FieldFormatter,dg.modules.core.FieldFormatter.number_float.prototype.constructor=dg.modules.core.FieldFormatter.number_float,dg.modules.core.FieldFormatter.number_float.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_theme:"number_float",_item:c[e]};return d},dg.modules.core.FieldFormatter.number_integer=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.core.FieldFormatter.number_integer.prototype=new dg.FieldFormatter,dg.modules.core.FieldFormatter.number_integer.prototype.constructor=dg.modules.core.FieldFormatter.number_integer,dg.modules.core.FieldFormatter.number_integer.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_theme:"number_integer",_item:c[e]};return d},dg.modules.core.FieldFormatter.string=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.core.FieldFormatter.string.prototype=new dg.FieldFormatter,dg.modules.core.FieldFormatter.string.prototype.constructor=dg.modules.core.FieldFormatter.string,dg.modules.core.FieldFormatter.string.prototype.viewElements=function(a,b){var c=a.getItems(),d={};
if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_theme:"string",_item:c[e]};return d},dg.modules.core.FieldWidget={},dg.modules.core.FieldWidget.decimal=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget.decimal.prototype=new dg.FieldWidget,dg.modules.core.FieldWidget.decimal.prototype.constructor=dg.modules.core.FieldWidget.decimal,dg.modules.core.FieldWidget.decimal.prototype.form=function(a,b,c,d,e){c._type="number",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",c._attributes.step="any",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FieldWidget["float"]=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget["float"].prototype=new dg.FieldWidget,dg.modules.core.FieldWidget["float"].prototype.constructor=dg.modules.core.FieldWidget["float"],dg.modules.core.FieldWidget["float"].prototype.form=function(a,b,c,d,e){c._type="number",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",c._attributes.step="any",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FieldWidget.integer=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget.integer.prototype=new dg.FieldWidget,dg.modules.core.FieldWidget.integer.prototype.constructor=dg.modules.core.FieldWidget.integer,dg.modules.core.FieldWidget.integer.prototype.form=function(a,b,c,d,e){c._type="number",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FieldWidget.string=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget.string.prototype=new dg.FieldWidget,dg.modules.core.FieldWidget.string.prototype.constructor=dg.modules.core.FieldWidget.string,dg.modules.core.FieldWidget.string.prototype.form=function(a,b,c,d,e){c._type="textfield",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget={},dg.modules.core.FormWidget.string_textfield=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.string_textfield.prototype=new dg.FormWidget,dg.modules.core.FormWidget.string_textfield.prototype.constructor=dg.modules.core.FormWidget.string_textfield,dg.modules.core.FormWidget.string_textfield.prototype.form=function(a,b,c,d,e){c._type="textfield",c._title=this.fieldName,c._title_placeholder=!0,c._widgetType="FormWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget.bundle=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.bundle.prototype=new dg.FormWidget,dg.modules.core.FormWidget.bundle.prototype.constructor=dg.modules.core.FormWidget.bundle,dg.modules.core.FormWidget.bundle.prototype.form=function(a,b,c,d,e){c._type="hidden",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget.bundle.prototype.valueCallback=function(a,b,c){var d=new(dg[jDrupal.ucfirst(this.get("entityType"))])(null);return{name:d.getEntityKey("bundle"),value:[{target_id:this.get("bundle")}]}},dg.modules.core.FormWidget.entityID=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.entityID.prototype=new dg.FormWidget,dg.modules.core.FormWidget.entityID.prototype.constructor=dg.modules.core.FormWidget.entityID,dg.modules.core.FormWidget.entityID.prototype.form=function(a,b,c,d,e){c._type="hidden",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.theme_container=function(a){return"<div "+dg.attributes(a._attributes)+">"+dg.render(a._children)+"</div>"},dg.theme_entity_reference_label=function(a){var b=a._item;return dg.l(b.target_id,b.url.replace(dg.path(),""))},dg.theme_string=function(a){return a._item.value},dg.theme_number_decimal=function(a){return a._item.value},dg.theme_number_float=function(a){return a._item.value},dg.theme_number_integer=function(a){return a._item.value},dg.modules.image=new dg.Module,dg.modules.image.FieldFormatter={},dg.modules.image.FieldFormatter.image=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.image.FieldFormatter.image.prototype=new dg.FieldFormatter,dg.modules.image.FieldFormatter.image.prototype.constructor=dg.modules.image.FieldFormatter.image,dg.modules.image.FieldFormatter.image.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++){var f=c[e];d[e]={_theme:"image",_path:f.url,_attributes:{alt:f.alt,title:f.title,width:f.width,height:f.height}}}return d},dg.modules.node=new dg.Module,dg.modules.node.routing=function(){var a={};return a["node.add.type"]={path:"/node/add/(.*)",defaults:{_form:"NodeEdit",_title:"Create content"}},a["node.add"]={path:"/node/add",defaults:{_controller:function(){return new Promise(function(a,b){var c=[];for(var d in dg.allBundleInfo.node)dg.allBundleInfo.node.hasOwnProperty(d)&&c.push(dg.l(dg.allBundleInfo.node[d].label,"node/add/"+d));var e={};e.types={_theme:"item_list",_items:c},a(e)})},_title:"Create content"}},a["node.edit"]={path:"/node/(.*)/edit",defaults:{_form:"NodeEdit",_title:"Node edit"}},a.node={path:"/node/(.*)",defaults:{_controller:function(a){return new Promise(function(b,c){dg.nodeLoad(a).then(function(a){dg.entityRenderContent(a).then(b)})})},_title:"Node"}},a};var NodeEdit=function(){this.entity=null,this.entityType="node",this.bundle=null,this.entityID=null,arguments[0]&&(jDrupal.isInt(arguments[0])?this.entityID=arguments[0]:(this.entity=new(dg[jDrupal.ucfirst(this.entityType)])(null),this.bundle=arguments[0]));var a=this;this.buildForm=function(b,c){return new Promise(function(c,d){var e=function(){var d=a.entityType,e=a.bundle,f=a.entity,g=dg.entity_form_mode[d][e];b._entity=f,b._entityType=d,b._bundle=e,b[f.getEntityKey("bundle")]={_type:"bundle",_widgetType:"FormWidget",_module:"core",_entityType:d,_bundle:e,_value:e};for(var h in g)if(g.hasOwnProperty(h)){var i=dg.fieldStorageConfig[d][h];if(i){var j=i.module;if(!j)continue;if(!jDrupal.moduleExists(j)){console.log('buildForm - The "'+j+'" module is not present for the widget on the "'+h+'" field.');continue}if(!dg.modules[j].FieldWidget||!dg.modules[j].FieldWidget[i.type]){console.log('buildForm - There is no "'+i.type+'" widget in the "'+j+'" module to handle the "'+h+'" field.');continue}var k=new dg.FieldFormMode(g[h]);b[h]={_type:i.type,_widgetType:"FieldWidget",_module:j,_entityType:d,_bundle:e,_fieldName:h,_fieldFormMode:k,_weight:k.getWeight()}}else{var l=g[h].type;if(!dg.modules.core.FormWidget[l]){console.log('buildForm - There is no "'+l+'" widget in the core module to handle the "'+h+'" element.');continue}var k=new dg.FieldFormMode(g[h]);b[h]={_type:l,_widgetType:"FormWidget",_module:"core",_entityType:d,_bundle:e,_fieldName:h,_fieldFormMode:k,_weight:k.getWeight()}}}b.actions={_type:"actions",submit:{_type:"submit",_value:"Save",_button_type:"primary"},_weight:999},c(b)};a.entityID?dg.nodeLoad(a.entityID).then(function(c){a.entity=c,a.bundle=c.getBundle(),b[c.getEntityKey("id")]={_type:"entityID",_widgetType:"FormWidget",_module:"core",_value:a.entityID},e()}):e()})},this.submitForm=function(a,b){return new Promise(function(c,d){var e=new(jDrupal[jDrupal.ucfirst(a._entityType)])(b.getValues());e.save().then(function(){a._action||(a._action=a._entityType+"/"+e.id()),c()})})}};NodeEdit.prototype=new dg.Form("NodeEdit"),NodeEdit.constructor=NodeEdit,dg.modules.system=new dg.Module,dg.modules.system.routing=function(){var a={};return a["system.dashboard"]={path:"/dg",defaults:{_title:"Getting started",_controller:function(){return new Promise(function(a,b){var c={},d=dg.currentUser(),e="Welcome to DrupalGap, ";e+=d.isAuthenticated()?d.getAccountName()+"!":dg.l("click here","http://docs.drupalgap.org/8")+" to view the documentation.",c.welcome={_markup:"<p>"+e+"</p>"},c.header={_markup:"<h2>"+dg.t("Resources")+"</h2>"},c.resources={_theme:"item_list",_items:[dg.l(dg.t("Hello World"),"http://docs.drupalgap.org/8/Hello_World"),dg.l(dg.t("Create a Module"),"http://docs.drupalgap.org/8/Modules/Create_a_Custom_Module")]},a(c)})}}},a["system.404"]={path:"/404",defaults:{_title:"404 - Page not found",_controller:function(){return new Promise(function(a,b){a("Sorry, that page was not found...")})}}},a},dg.modules.system.blocks=function(){var a={};return a.logo={build:function(){return new Promise(function(a,b){a(dg.config("logo"))})}},a.main={build:function(){return new Promise(function(a,b){a(dg.content)})}},a.main_menu={build:function(){return new Promise(function(a,b){var c={},d=[dg.l(dg.t("Home"),"")];c.menu={_theme:"item_list",_items:d},a(c)})}},a.powered_by={build:function(){return new Promise(function(a,b){var c={};c.list={_theme:"item_list",_title:dg.t("Powered by"),_items:[dg.l("DrupalGap","http://drupalgap.org"),dg.l("Drupal","http://drupal.org")]},a(c)})}},a.title={build:function(){return new Promise(function(a,b){var c=dg.getTitle();if("string"==typeof c){var d={_theme:"title",_title:dg.t(c)};a(d)}else a(c)})}},a},dg.modules.text=new dg.Module,dg.modules.text=new dg.Module,dg.modules.text.FieldFormatter={},dg.modules.text.FieldFormatter.text_default=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.text.FieldFormatter.text_default.prototype=new dg.FieldFormatter,dg.modules.text.FieldFormatter.text_default.prototype.constructor=dg.modules.text.FieldFormatter.text_default,dg.modules.text.FieldFormatter.text_default.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_markup:c[e].value};return d},dg.modules.text.FieldWidget={},dg.modules.text.FieldWidget.text_with_summary=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.text.FieldWidget.text_with_summary.prototype=new dg.FieldWidget,dg.modules.text.FieldWidget.text_with_summary.prototype.constructor=dg.modules.text.FieldWidget.text_with_summary,dg.modules.text.FieldWidget.text_with_summary.prototype.form=function(a,b,c,d,e){c._type="textarea",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="text",a&&"undefined"!==a[b]&&(c._value=a[b].value)},dg.modules.user=new dg.Module,dg.modules.user.routing=function(){var a={};return a["user.login"]={path:"/user/login",defaults:{_form:"UserLoginForm",_title:"Log in"}},a["user.logout"]={path:"/user/logout",defaults:{_title:"Log out",_controller:function(){return new Promise(function(a,b){a("Logging out..."),jDrupal.userLogout().then(function(){dg["goto"](dg.getFrontPagePath())})})}}},a.user={path:"/user/(.*)",defaults:{_controller:function(a){return new Promise(function(b,c){dg.userLoad(a).then(function(a){dg.entityRenderContent(a).then(b)})})},_title:"user"}},a},dg.modules.user.blocks=function(){var a={};return a.user_login={build:function(){return new Promise(function(a,b){var c=dg.currentUser().isAuthenticated();if(!c&&"user/login"!=dg.getPath()){var d=dg.addForm("UserLoginForm",dg.applyToConstructor(UserLoginForm));d.get("form")._action=dg.getPath(),d.getForm().then(a)}})}},a.user_menu={build:function(){return new Promise(function(a,b){if(dg.currentUser().isAuthenticated()){var c={};c.menu={_theme:"item_list",_items:[dg.l(dg.t("My account"),"user/"+dg.currentUser().id()),dg.l(dg.t("Logout"),"user/logout")]},a(c)}else a()})}},a};var UserLoginForm=function(){this.buildForm=function(a,b){return new Promise(function(b,c){a._action||(a._action=dg.getFrontPagePath()),a.name={_type:"textfield",_title:"Username",_required:!0,_title_placeholder:!0},a.pass={_type:"password",_title:"Password",_required:!0,_title_placeholder:!0},a.actions={_type:"actions",submit:{_type:"submit",_value:"Log in",_button_type:"primary"}},b(a)})},this.submitForm=function(a,b){return new Promise(function(c,d){jDrupal.userLogin(b.getValue("name"),b.getValue("pass")).then(function(){dg.isFrontPage()?dg.router.check(dg.getFrontPagePath()):dg.getPath()==a._action&&dg.router.check(a._action),c()})})}};UserLoginForm.prototype=new dg.Form("UserLoginForm"),UserLoginForm.constructor=UserLoginForm;